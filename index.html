
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>GovTech TAM & SAM Calculator</title>
    <link rel="stylesheet" href="/assets/styles.css" />
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script type="text/javascript">
      const { useState, useMemo } = React;

      const currency = (n) => (isNaN(n) ? "$0" : n.toLocaleString(undefined, { style: "currency", currency: "USD", maximumFractionDigits: 0 }));
      const percentToFloat = (p) => { const x = parseFloat(p); if (isNaN(x)) return 0; return Math.min(Math.max(x,0),100)/100; };

      function App() {
        const sample = [
          { id: 1, size: "Small (≤25k)", count: 8000, adoption: 5, win: 30, price: 5000 },
          { id: 2, size: "Medium (25k–250k)", count: 1200, adoption: 10, win: 30, price: 15000 },
          { id: 3, size: "Large (≥250k)", count: 120, adoption: 20, win: 30, price: 50000 },
        ];
        const [rows, setRows] = useState(sample);
        const [globalPrice, setGlobalPrice] = useState("");
        const [globalAdoption, setGlobalAdoption] = useState("");
        const [globalWin, setGlobalWin] = useState("");

        const totals = useMemo(() => rows.reduce((acc, r) => {
          const price = parseFloat(r.price) || 0;
          const count = parseFloat(r.count) || 0;
          const adoption = percentToFloat(r.adoption);
          const win = percentToFloat(r.win || 0);
          acc.tam += count * price;
          acc.sam += count * adoption * price;
          acc.som += count * adoption * win * price;
          return acc;
        }, { tam:0, sam:0, som:0 }), [rows]);

        const updateRow = (id, field, value) => setRows(prev => prev.map(r => r.id === id ? { ...r, [field]: value } : r));
        const addRow = () => setRows(prev => [...prev, { id:(prev[prev.length-1]?.id||0)+1, size:"", count:"", adoption:"", win:"", price:"" }]);
        const removeRow = (id) => setRows(prev => prev.filter(r => r.id !== id));
        const applyGlobals = () => setRows(prev => prev.map(r => ({
          ...r,
          price: globalPrice !== "" ? globalPrice : r.price,
          adoption: globalAdoption !== "" ? globalAdoption : r.adoption,
          win: globalWin !== "" ? globalWin : r.win,
        })));
        const resetSample = () => setRows(sample);

        return React.createElement(React.Fragment, null,
          React.createElement('div', { className:'container' },
            React.createElement('h1', null, 'GovTech TAM & SAM Calculator'),
            React.createElement('p', { className:'muted' }, 'Estimate market size by government segment.'),

            React.createElement('div', { className:'card' },
              React.createElement('div', { className:'grid grid-6' },
                React.createElement('div', null,
                  React.createElement('label', { className:'label' }, 'Set all Prices ($/yr)'),
                  React.createElement('input', { className:'input', value:globalPrice, onInput:e=>setGlobalPrice(e.target.value) })
                ),
                React.createElement('div', null,
                  React.createElement('label', { className:'label' }, 'Set all Adoption %'),
                  React.createElement('input', { className:'input', value:globalAdoption, onInput:e=>setGlobalAdoption(e.target.value) })
                ),
                React.createElement('div', null,
                  React.createElement('label', { className:'label' }, 'Set all Win %'),
                  React.createElement('input', { className:'input', value:globalWin, onInput:e=>setGlobalWin(e.target.value) })
                )
              ),
              React.createElement('div', { style:{ display:'flex', gap:'8px', marginTop:'8px' } },
                React.createElement('button', { className:'btn primary', onClick:applyGlobals }, 'Apply to all'),
                React.createElement('button', { className:'btn', onClick:resetSample }, 'Reset sample')
              )
            ),

            React.createElement('div', { className:'grid grid-3', style:{ margin:'16px 0' } },
              React.createElement('div', { className:'stat' },
                React.createElement('div', { className:'label' }, 'TAM'),
                React.createElement('div', { className:'value' }, currency(totals.tam))
              ),
              React.createElement('div', { className:'stat' },
                React.createElement('div', { className:'label' }, 'SAM'),
                React.createElement('div', { className:'value' }, currency(totals.sam))
              ),
              React.createElement('div', { className:'stat' },
                React.createElement('div', { className:'label' }, 'SOM'),
                React.createElement('div', { className:'value' }, currency(totals.som))
              )
            ),

            React.createElement('div', { className:'card' },
              React.createElement('table', { className:'table' },
                React.createElement('thead', null,
                  React.createElement('tr', null,
                    React.createElement('th', null, 'Size'),
                    React.createElement('th', { className:'right' }, 'Gov Count'),
                    React.createElement('th', { className:'right' }, 'Adoption %'),
                    React.createElement('th', { className:'right' }, 'Win %'),
                    React.createElement('th', { className:'right' }, 'Price/Year'),
                    React.createElement('th', { className:'right' }, 'TAM'),
                    React.createElement('th', { className:'right' }, 'SAM'),
                    React.createElement('th', { className:'right' }, 'SOM'),
                    React.createElement('th', null, '')
                  )
                ),
                React.createElement('tbody', null,
                  rows.map(r => {
                    const count = parseFloat(r.count) || 0;
                    const price = parseFloat(r.price) || 0;
                    const adoption = percentToFloat(r.adoption);
                    const win = percentToFloat(r.win || 0);
                    const tam = count * price;
                    const sam = count * adoption * price;
                    const som = count * adoption * win * price;
                    return React.createElement('tr', { key:r.id },
                      React.createElement('td', null, React.createElement('input', { className:'input', value:r.size, onInput:e=>updateRow(r.id,'size',e.target.value) })),
                      React.createElement('td', { className:'right' }, React.createElement('input', { className:'input', value:r.count, onInput:e=>updateRow(r.id,'count',e.target.value) })),
                      React.createElement('td', { className:'right' }, React.createElement('input', { className:'input', value:r.adoption, onInput:e=>updateRow(r.id,'adoption',e.target.value) })),
                      React.createElement('td', { className:'right' }, React.createElement('input', { className:'input', value:r.win, onInput:e=>updateRow(r.id,'win',e.target.value) })),
                      React.createElement('td', { className:'right' }, React.createElement('input', { className:'input', value:r.price, onInput:e=>updateRow(r.id,'price',e.target.value) })),
                      React.createElement('td', { className:'right' }, React.createElement('span', { className:'pill tam' }, currency(tam))),
                      React.createElement('td', { className:'right' }, React.createElement('span', { className:'pill sam' }, currency(sam))),
                      React.createElement('td', { className:'right' }, React.createElement('span', { className:'pill som' }, currency(som))),
                      React.createElement('td', null, React.createElement('button', { className:'btn', onClick:()=>removeRow(r.id) }, 'Remove'))
                    );
                  })
                )
              )
            )
          )
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(App));
    </script>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
